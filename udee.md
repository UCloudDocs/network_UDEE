# 内网域名解析 UDEE

## UDEE简介

UCloud Domain Element
Engine（内网域名解析引擎），是基于UCloud云平台DNS解析系统，能够为云平台中的资源提供基于内网传输的自定义域名解析功能。

用户可自定义域名组，并在域名组中添加解析记录，以实现域名解析功能，为基于DNS方式实现负载均衡和高可用架构提供服务基础。

## UDEE基本概念

### 域名组

域名组是以用户自定义名称为基础域名的二级域名集合，域名组全名由“名称.随机码.custom.ucloud.cn”组成。

**note**

“随机码” 是系统自动根据用户账户及数据中心所生成的，在同数据中心中唯一的标示。

### 解析记录

以域名组为基础域名的二级域名记录，包含记录类型(目前仅支持A记录)、IP地址、TTL值等选项。

## UDEE的工作原理

UDee能够为内网服务提供域名解析功能，所解析地址包括内网服务的地址，如云主机、物理云主机、云数据库、云内存存储等有明确内网IP地址的服务，并能够对相同二级域名添加多条记录地址，还能够自定义添加内/外网地址作为解析记录，实现对外网服务或第三方应用的访问。

UDee的工作原理如下图所示：

![image](/images/udee1.png)

1.  当内网主机对已定义的UDee域名进行访问时，首先会向数据中心DNS服务(由UDee提供)询问该域名对应的IP地址。
2.  当中心DNS服务获取用户请求时，会根据域名组寻找已经定义的二级域名，如图中域名组为 "project1"，所查询二级域名为
    "app1"。
3.  经查询可知，二级域名 "app1" 对应了3条解析记录，分别是 "10.0.0.1"、"10.0.0.2"、"10.0.0.3"，其中
    "10.0.0.3" 所对应的状态为 "禁用"。
4.  中心DNS服务随机返回给主机一条已启用的解析记录，即 "10.0.0.1" 或 "10.0.0.2"，主机得到解析记录后，会根据记录的
    "TTL" 值，将记录缓存到本地，并在有效周期内不再询问中心DNS服务进行查询。
5.  主机根据所缓存域名记录的地址，对相应地址进行访问，当记录缓存时间达到 "TTL"
    值后，该主机会再次进行查询。若缓存失效前记录状态被"禁用"，则缓存时间会被立即刷新，主机会重新请求所对应地址。

## UDEE基本操作

### 创建域名组

在控制台中点击添加域名组，填入域名组基础域名及备注（备注可创建完毕后进行修改）即可。域名组名称需符合域名定义方式（仅支持英文、数字及点号(.)，并且不可使用点号开头结尾）。

**note**

所创建域名组在同数据中心下名称唯一。域名组名称建立后不可修改，若已添加了解析记录但希望修改域名组名称，可通过复制域名组的方式使用新的名称建立域名组，建立完毕后再删除旧的域名组即可。

![image](/images/udee2.png)

### 管理解析记录

创建好域名组后，可以在域名组中进行"解析记录"的管理，可对"解析记录"进行新建和删除，编辑解析记录中包含的各个选项，并可对解析记录的状态进行修改。

![image](/images/udee3.png)

以添加记录为例，点击 "添加记录" 按钮，依次填入 "二级域名", "IP地址" 及 TTL值。本例中 "二级域名" 为
"thirdpart"，即解析时对应域名为 "thirdpart.project1.xxxxxx.custom.ucloud.cn"；

在IP所属资源中，目前可获取地址包含 "云主机"、"物理云主机" 及 "内网VIP"，本例中选择
"手动填写"，是因为该IP为第三方服务的外网IP。

![image](/images/udee4.png)

### 复制域名组

复制域名组能够对一个已存在的域名组进行复制，所复制内容包含该域名组中所有规则。本例中 "被复制域名组" 为 project1，"新域名组" 为
project2。

![image](/images/udee5.png)

![image](/images/udee6.png)

### 删除域名组

"删除域名组" 会删除域名组中所有已定义的解析记录，删除后会根据购买时常及已使用时长进行实时退费，删除域名组时支持批量操作。

![image](/images/udee7.png)
